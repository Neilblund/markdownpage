<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tips for final project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tips_for_final_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="tips_for_final_project_files/libs/quarto-html/quarto.js"></script>
<script src="tips_for_final_project_files/libs/quarto-html/popper.min.js"></script>
<script src="tips_for_final_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tips_for_final_project_files/libs/quarto-html/anchor.min.js"></script>
<link href="tips_for_final_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tips_for_final_project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tips_for_final_project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tips_for_final_project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tips_for_final_project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="tips_for_final_project_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="tips_for_final_project_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#about-this-document" id="toc-about-this-document" class="nav-link active" data-scroll-target="#about-this-document"><span class="header-section-number">1</span> About this document</a>
  <ul>
  <li><a href="#notes-and-faqs" id="toc-notes-and-faqs" class="nav-link" data-scroll-target="#notes-and-faqs"><span class="header-section-number">1.1</span> Notes and FAQs</a></li>
  </ul></li>
  <li><a href="#importing-the-data-into-r" id="toc-importing-the-data-into-r" class="nav-link" data-scroll-target="#importing-the-data-into-r"><span class="header-section-number">2</span> Importing the data into R</a></li>
  <li><a href="#recoding-variables" id="toc-recoding-variables" class="nav-link" data-scroll-target="#recoding-variables"><span class="header-section-number">3</span> Recoding variables</a>
  <ul>
  <li><a href="#reordering-a-variable" id="toc-reordering-a-variable" class="nav-link" data-scroll-target="#reordering-a-variable"><span class="header-section-number">3.1</span> Reordering a variable</a></li>
  <li><a href="#changing-and-combining-labels" id="toc-changing-and-combining-labels" class="nav-link" data-scroll-target="#changing-and-combining-labels"><span class="header-section-number">3.2</span> Changing and combining labels</a></li>
  <li><a href="#ordinal-variables-as-numeric" id="toc-ordinal-variables-as-numeric" class="nav-link" data-scroll-target="#ordinal-variables-as-numeric"><span class="header-section-number">3.3</span> Ordinal variables as numeric</a></li>
  <li><a href="#dichotomous-variables-as-numeric" id="toc-dichotomous-variables-as-numeric" class="nav-link" data-scroll-target="#dichotomous-variables-as-numeric"><span class="header-section-number">3.4</span> Dichotomous variables as numeric</a></li>
  <li><a href="#recoding-with-logical-statements" id="toc-recoding-with-logical-statements" class="nav-link" data-scroll-target="#recoding-with-logical-statements"><span class="header-section-number">3.5</span> Recoding with logical statements</a></li>
  <li><a href="#changing-the-excluded-category-of-a-factor" id="toc-changing-the-excluded-category-of-a-factor" class="nav-link" data-scroll-target="#changing-the-excluded-category-of-a-factor"><span class="header-section-number">3.6</span> Changing the excluded category of a factor</a></li>
  </ul></li>
  <li><a href="#formatting-output-for-the-final-paper" id="toc-formatting-output-for-the-final-paper" class="nav-link" data-scroll-target="#formatting-output-for-the-final-paper"><span class="header-section-number">4</span> Formatting output for the final paper</a>
  <ul>
  <li><a href="#using-printc-to-format-tables-and-models" id="toc-using-printc-to-format-tables-and-models" class="nav-link" data-scroll-target="#using-printc-to-format-tables-and-models"><span class="header-section-number">4.1</span> Using printC to format tables and models</a></li>
  <li><a href="#exporting-plots-to-word" id="toc-exporting-plots-to-word" class="nav-link" data-scroll-target="#exporting-plots-to-word"><span class="header-section-number">4.2</span> Exporting plots to word</a></li>
  </ul></li>
  <li><a href="#example-plots-and-tables" id="toc-example-plots-and-tables" class="nav-link" data-scroll-target="#example-plots-and-tables"><span class="header-section-number">5</span> Example plots and tables</a>
  <ul>
  <li><a href="#plots-and-tables-for-a-single-variable" id="toc-plots-and-tables-for-a-single-variable" class="nav-link" data-scroll-target="#plots-and-tables-for-a-single-variable"><span class="header-section-number">5.1</span> Plots and tables for a single variable</a>
  <ul class="collapse">
  <li><a href="#freq" id="toc-freq" class="nav-link" data-scroll-target="#freq"><span class="header-section-number">5.1.1</span> freq</a></li>
  <li><a href="#histograms-or-density-plots" id="toc-histograms-or-density-plots" class="nav-link" data-scroll-target="#histograms-or-density-plots"><span class="header-section-number">5.1.2</span> histograms or density plots</a></li>
  <li><a href="#describe" id="toc-describe" class="nav-link" data-scroll-target="#describe"><span class="header-section-number">5.1.3</span> describe</a></li>
  <li><a href="#tableprop.table" id="toc-tableprop.table" class="nav-link" data-scroll-target="#tableprop.table"><span class="header-section-number">5.1.4</span> table/prop.table</a></li>
  </ul></li>
  <li><a href="#plots-for-multiple-variables" id="toc-plots-for-multiple-variables" class="nav-link" data-scroll-target="#plots-for-multiple-variables"><span class="header-section-number">5.2</span> Plots for multiple variables</a>
  <ul class="collapse">
  <li><a href="#plotmeansc" id="toc-plotmeansc" class="nav-link" data-scroll-target="#plotmeansc"><span class="header-section-number">5.2.1</span> plotmeansC</a></li>
  <li><a href="#plotmeans" id="toc-plotmeans" class="nav-link" data-scroll-target="#plotmeans"><span class="header-section-number">5.2.2</span> plotmeans</a></li>
  <li><a href="#compmeans" id="toc-compmeans" class="nav-link" data-scroll-target="#compmeans"><span class="header-section-number">5.2.3</span> compmeans</a></li>
  <li><a href="#boxplot-stripchart" id="toc-boxplot-stripchart" class="nav-link" data-scroll-target="#boxplot-stripchart"><span class="header-section-number">5.2.4</span> boxplot + stripchart</a></li>
  <li><a href="#crosstab" id="toc-crosstab" class="nav-link" data-scroll-target="#crosstab"><span class="header-section-number">5.2.5</span> crosstab</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#interpreting-logistic-regression-models" id="toc-interpreting-logistic-regression-models" class="nav-link" data-scroll-target="#interpreting-logistic-regression-models"><span class="header-section-number">6</span> Interpreting logistic regression models</a>
  <ul>
  <li><a href="#model-coefficients" id="toc-model-coefficients" class="nav-link" data-scroll-target="#model-coefficients"><span class="header-section-number">6.0.1</span> Model Coefficients</a></li>
  <li><a href="#exponentiation-and-odds-ratios" id="toc-exponentiation-and-odds-ratios" class="nav-link" data-scroll-target="#exponentiation-and-odds-ratios"><span class="header-section-number">6.0.2</span> Exponentiation and odds ratios</a></li>
  <li><a href="#predicted-probabilities" id="toc-predicted-probabilities" class="nav-link" data-scroll-target="#predicted-probabilities"><span class="header-section-number">6.0.3</span> Predicted probabilities</a></li>
  <li><a href="#assessing-model-fit" id="toc-assessing-model-fit" class="nav-link" data-scroll-target="#assessing-model-fit"><span class="header-section-number">6.0.4</span> Assessing model fit</a></li>
  </ul></li>
  <li><a href="#plots-for-predicted-probabilities" id="toc-plots-for-predicted-probabilities" class="nav-link" data-scroll-target="#plots-for-predicted-probabilities"><span class="header-section-number">7</span> Plots for predicted probabilities</a>
  <ul>
  <li><a href="#using-the-pred_ci-function" id="toc-using-the-pred_ci-function" class="nav-link" data-scroll-target="#using-the-pred_ci-function"><span class="header-section-number">7.1</span> Using the pred_ci function</a></li>
  <li><a href="#logit-with-categorical-ivs" id="toc-logit-with-categorical-ivs" class="nav-link" data-scroll-target="#logit-with-categorical-ivs"><span class="header-section-number">7.2</span> Logit with categorical IVs</a>
  <ul class="collapse">
  <li><a href="#generating-the-predictions" id="toc-generating-the-predictions" class="nav-link" data-scroll-target="#generating-the-predictions"><span class="header-section-number">7.2.1</span> Generating the predictions</a></li>
  <li><a href="#using-plot" id="toc-using-plot" class="nav-link" data-scroll-target="#using-plot"><span class="header-section-number">7.2.2</span> Using plot()</a>
  <ul class="collapse">
  <li><a href="#same-plot-with-color-coding" id="toc-same-plot-with-color-coding" class="nav-link" data-scroll-target="#same-plot-with-color-coding"><span class="header-section-number">7.2.2.1</span> Same plot with color-coding</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logit-with-continuous-ivs" id="toc-logit-with-continuous-ivs" class="nav-link" data-scroll-target="#logit-with-continuous-ivs"><span class="header-section-number">7.3</span> Logit with continuous IVs</a>
  <ul class="collapse">
  <li><a href="#generating-the-predictions-1" id="toc-generating-the-predictions-1" class="nav-link" data-scroll-target="#generating-the-predictions-1"><span class="header-section-number">7.3.1</span> Generating the predictions</a></li>
  <li><a href="#using-plot-1" id="toc-using-plot-1" class="nav-link" data-scroll-target="#using-plot-1"><span class="header-section-number">7.3.2</span> Using plot()</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#extra-stuff-prediction-plots-using-ggeffects" id="toc-extra-stuff-prediction-plots-using-ggeffects" class="nav-link" data-scroll-target="#extra-stuff-prediction-plots-using-ggeffects"><span class="header-section-number">8</span> Extra stuff: prediction plots using ggeffects</a>
  <ul>
  <li><a href="#using-predict_response" id="toc-using-predict_response" class="nav-link" data-scroll-target="#using-predict_response"><span class="header-section-number">8.1</span> Using predict_response</a></li>
  <li><a href="#ggeffects-with-categorical-ivs" id="toc-ggeffects-with-categorical-ivs" class="nav-link" data-scroll-target="#ggeffects-with-categorical-ivs"><span class="header-section-number">8.2</span> ggeffects with categorical IVs</a></li>
  <li><a href="#ggeffects-with-continuous-ivs" id="toc-ggeffects-with-continuous-ivs" class="nav-link" data-scroll-target="#ggeffects-with-continuous-ivs"><span class="header-section-number">8.3</span> ggeffects with continuous IVs</a></li>
  <li><a href="#ggeffects-with-multiple-continuous-ivs" id="toc-ggeffects-with-multiple-continuous-ivs" class="nav-link" data-scroll-target="#ggeffects-with-multiple-continuous-ivs"><span class="header-section-number">8.4</span> ggeffects with Multiple continuous IVs</a></li>
  <li><a href="#marginal-effects-1" id="toc-marginal-effects-1" class="nav-link" data-scroll-target="#marginal-effects-1"><span class="header-section-number">8.5</span> Marginal Effects</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tips for final project</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="about-this-document" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> About this document</h1>
<p>This document offers some general advice, example code, and other suggestions for how you can improve your final analysis for this course. Its not meant to be a replacement for attending class, viewing the lectures, reviewing the slides, or meeting with me or the TAs. If you’ve reviewed the materials and you’re still not sure how to do something, reach out sooner rather than later.</p>
<section id="notes-and-faqs" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="notes-and-faqs"><span class="header-section-number">1.1</span> Notes and FAQs</h2>
<p>(I’ll be adding stuff to this section as I enounter it)</p>
<ul>
<li>The data for the final project doesn’t have weights, and you don’t need to use any of the <code>svy</code> functions to analyze it. Keep in mind, however, that these data are still not representative of the general population, so you should acknowledge that this is a non-random sample when you discuss your results and the limitations of your analysis.</li>
</ul>
</section>
</section>
<section id="importing-the-data-into-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Importing the data into R</h1>
<p>The final project data set is stored in .csv format and will need to be imported into R before you can start your analysis. I think the easiest way to do this is to use the graphical interface in Rstudio to import it the first time, and then copy-paste the code into your R script so you can just re-run the import commands the next time you open R.</p>
<p>To do this, you’ll want to start by clicking the “import dataset” button in the top right pane of Rstudio and then select “from text (readr)”.</p>
<p><img src="importing_readcsv.png" class="img-fluid"></p>
<p>This will bring up a graphical interface where you can browse for the data you want to import. Find your copy of the final project data and then click “done” to start the import.</p>
<p><img src="importing_browse.png" class="img-fluid"></p>
<p>Once the data is loaded, you can click the import button to load it into R, but before you do that, you should copy that code that appears in the “code preview” window. These are the commands you can use to import the data next time you need it.</p>
<p><img src="importing_savecode.png" class="img-fluid"></p>
<p>Finally, you’ll want to paste the code from the console into your script. I would also recommend you change the name you’re giving the data set to something shorter than the default that Rstudio gives it (just for convenience) and you will probably want to get rid of that third command <code>View()</code> since that just makes the data set pop up in a new window so you can look at it.</p>
<p><img src="importing_inscript.png" class="img-fluid"></p>
<p>Save this script with a name like “final project script” and now you can just run these two lines of code next time you need to import this dataset. Here’s what the first few lines of my script my look like. Obviously, you would want to change the part in quotation marks to match the file path where you’ve saved the final project data, but otherwise, this set of commands should work for you:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poliscidata)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"final_project/FINAL project dataset ct.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recoding-variables" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Recoding variables</h1>
<p>The data sets you’ve been using for most of this class have already been cleaned and formatted for the most part, but, like most real-world data, the data for your final project will usually require some modifications before you can really make good use of them.</p>
<section id="reordering-a-variable" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="reordering-a-variable"><span class="header-section-number">3.1</span> Reordering a variable</h2>
<p>One very common problem is that R will try to alphabetize categorical variables, even when alphabetical order is a nonsenical way to present the data. For instance, Q35 ask respondents to state the highest level of education they have attained. It makes intuitive sense to order this variable from the fewest years of education to the most, but R doesn’t do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(final_data<span class="sc">$</span>Q35, <span class="at">plot=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 79%">
<col style="width: 11%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Frequency</th>
<th style="text-align: right;">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Associate degree in college (2-years)</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">13.359</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bachelor’s degree in college (4-years)</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">22.519</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Doctoral degree</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1.399</td>
</tr>
<tr class="even">
<td style="text-align: left;">High school graduate (high school diploma or equivalent including GED)</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">24.173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Less than high school degree</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">3.435</td>
</tr>
<tr class="even">
<td style="text-align: left;">Master’s degree</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">12.087</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Professional degree (JD, MD)</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">2.290</td>
</tr>
<tr class="even">
<td style="text-align: left;">Some college but no degree</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">20.738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">786</td>
<td style="text-align: right;">100.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So, to fix this, we can use the <code>factor</code> command to create a factor variable where the levels are listed in the appropriate order. You can do this by first: creating a vector that has each level of Q35 listed in order, and then passing that vector to the <code>levels</code> argument of the factor function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># education levels listed from lowest to highest: </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>education_levels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Less than high school degree"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"High school graduate (high school diploma or equivalent including GED)"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Some college but no degree"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Associate degree in college (2-years)"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Bachelor's degree in college (4-years)"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Master's degree"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Professional degree (JD, MD)"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Doctoral degree"</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># a new column called "education" with the levels in order: </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>education <span class="ot">=</span> <span class="fu">factor</span>(final_data<span class="sc">$</span>Q35, <span class="at">levels=</span>education_levels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, when you create a frequency table for this new factor variable, the levels should appear in the correct order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(final_data<span class="sc">$</span>education, <span class="at">plot=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 79%">
<col style="width: 11%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Frequency</th>
<th style="text-align: right;">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Less than high school degree</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">3.435</td>
</tr>
<tr class="even">
<td style="text-align: left;">High school graduate (high school diploma or equivalent including GED)</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">24.173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Some college but no degree</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">20.738</td>
</tr>
<tr class="even">
<td style="text-align: left;">Associate degree in college (2-years)</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">13.359</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bachelor’s degree in college (4-years)</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">22.519</td>
</tr>
<tr class="even">
<td style="text-align: left;">Master’s degree</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">12.087</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Professional degree (JD, MD)</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">2.290</td>
</tr>
<tr class="even">
<td style="text-align: left;">Doctoral degree</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1.399</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">786</td>
<td style="text-align: right;">100.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="changing-and-combining-labels" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="changing-and-combining-labels"><span class="header-section-number">3.2</span> Changing and combining labels</h2>
<p>In some cases, it might also make sense to shorten the names of some factor levels so they can fit on a plot, or even combine some levels together. To do this, you would want to follow the same process you used above, but add a vector of “labels” that will represent the new values for your recoded variable. For instance, the code below will give shorter names to each factor level, and will also combine the Master’s, Professional, and PhD respondents under a single level called “Graduate degree”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># education levels listed from lowest to highest: </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>education_levels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Less than high school degree"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"High school graduate (high school diploma or equivalent including GED)"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Some college but no degree"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Associate degree in college (2-years)"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Bachelor's degree in college (4-years)"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Master's degree"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Professional degree (JD, MD)"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Doctoral degree"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the new labels for each level</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>education_labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"less than high school"</span>, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"High school"</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Some college"</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"2-year degree"</span>, </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"4-year degree"</span>, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Graduate degree"</span>,  <span class="co"># same label listed three times </span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Graduate degree"</span>,  <span class="co"># this will combine the last three</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Graduate degree"</span>)  <span class="co"># factor levels under a single label</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># a new column called "education" with the levels in order: </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>education_recode <span class="ot">=</span> <span class="fu">factor</span>(final_data<span class="sc">$</span>Q35, <span class="at">levels=</span>education_levels, <span class="at">labels=</span>education_labels)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="fu">freq</span>(final_data<span class="sc">$</span>education_recode, <span class="at">plot=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Frequency</th>
<th style="text-align: right;">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">less than high school</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">3.435</td>
</tr>
<tr class="even">
<td style="text-align: left;">High school</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">24.173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Some college</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">20.738</td>
</tr>
<tr class="even">
<td style="text-align: left;">2-year degree</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">13.359</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4-year degree</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">22.519</td>
</tr>
<tr class="even">
<td style="text-align: left;">Graduate degree</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">15.776</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">786</td>
<td style="text-align: right;">100.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ordinal-variables-as-numeric" class="level2 page-columns page-full" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="ordinal-variables-as-numeric"><span class="header-section-number">3.3</span> Ordinal variables as numeric</h2>
<p>Finally, if I have created a properly ordered categorical variable, I might want to treat that variable as numeric in my regression analysis. This might result in losing important information*, but it would simplify the interpretation of my model results because I will just a get a single coefficient for the effect of education instead of having K-1 separate coefficients representing each value. To do this, you can just use the <code>as.numeric</code> function:</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note: the downside to changing a factor variable to numeric is that it means you’re assuming that the independent variable has a linear effect on the outcome. But this isn’t always the case: going from a high school education to a college education probably has a lot more impact that going from a Master’s degree to a PhD. This is a simplifying assumption that makes your model easier to interpret at the cost of potentially ignoring important nuances about how the world actually works.</p>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>educ_numeric <span class="ot">=</span> <span class="fu">as.numeric</span>(final_data<span class="sc">$</span>education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is especially handy if you have an independent variable with more than 7 categories. For instance, the income data in the NES has 28 levels, so a regression model using that variable would have 27 coefficients. By contrast, a numeric version of that variable results in a single model coefficient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a numeric version of the income variable: </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>inc_numeric <span class="ot">=</span> <span class="fu">as.numeric</span>(nes<span class="sc">$</span>inc_incgroup_pre)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># a regression model </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>numeric_model <span class="ot">=</span>  <span class="fu">glm</span>(voted2012 <span class="sc">~</span> inc_numeric, <span class="at">data=</span>nes, <span class="at">family=</span>binomial)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(numeric_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1)</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.655 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.064)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">inc_numeric</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.062 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.005)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5036&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>But if I convert the factor variable to a numeric variable, I can use something like <code>boxplot</code> to give a succinct summary of the relationship between income and voter turnout:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>income_numeric <span class="ot">=</span> <span class="fu">as.numeric</span>(nes<span class="sc">$</span>inc_incgroup_pre)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(income_numeric <span class="sc">~</span> voted2012, <span class="at">data=</span>nes,  <span class="at">xlab=</span><span class="st">"Turnout in 2012"</span>, <span class="at">ylab=</span><span class="st">"Income group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="dichotomous-variables-as-numeric" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="dichotomous-variables-as-numeric"><span class="header-section-number">3.4</span> Dichotomous variables as numeric</h2>
<p>Recoding a dichotomous variable to a dummy variable (0 or 1) isn’t strictly necessary, but it can be useful because the average of a dummy variable will correspond to the proportion of “1s” in the data. This may be especially helpful if you want to do something like visualize the percentage of some outcome across values of a categorical variable. For instance, to show voter turnout at different levels of party ID, I could run this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>voted08_numeric <span class="ot">=</span> <span class="fu">as.numeric</span>(nes<span class="sc">$</span>voted2008 <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(voted08_numeric<span class="sc">*</span><span class="dv">100</span> <span class="sc">~</span> pid_x, <span class="co"># * 100 to scale the results as % </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"% voted in 2008"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Party ID (7-categories)"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Voter turnout by party ID"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">connect =</span> <span class="cn">FALSE</span>, <span class="co"># change to TRUE to show a line connecting each point</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>nes) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="recoding-with-logical-statements" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="recoding-with-logical-statements"><span class="header-section-number">3.5</span> Recoding with logical statements</h2>
<p>Another pretty common scenario will be cases where you want to convert a factor variable into something binary. You can do this using R’s <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Logic.html">logical operators</a>. Here are some examples of logical operations I might use to change a variable:</p>
<p>Return TRUE if McCain won a state:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>states<span class="sc">$</span>mccain_win08 <span class="ot">=</span> states<span class="sc">$</span>obama_win08 <span class="sc">==</span> <span class="st">"McCain win"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">obama_win08</th>
<th style="text-align: right;">TRUE</th>
<th style="text-align: right;">FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">McCain win</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Obama win</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Return TRUE if <code>pid_3</code> DOES NOT equal “Independent” (this would allow me to compare partisans to independents)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>not_independent <span class="ot">=</span>nes<span class="sc">$</span>pid_3 <span class="sc">!=</span><span class="st">"Ind"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">pid_3</th>
<th style="text-align: right;">TRUE</th>
<th style="text-align: right;">FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dem</td>
<td style="text-align: right;">2358</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ind</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2149</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rep</td>
<td style="text-align: right;">1385</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Return TRUE if a <code>relig</code> is one of the major sects of Christianity:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gss<span class="sc">$</span>xtian <span class="ot">=</span> gss<span class="sc">$</span>relig <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PROTESTANT"</span>, <span class="st">"CATHOLIC"</span>, <span class="st">"ORTHODOX-CHRISTIAN"</span>, <span class="st">"CHRISTIAN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">relig</th>
<th style="text-align: right;">TRUE</th>
<th style="text-align: right;">FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PROTESTANT</td>
<td style="text-align: right;">916</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">CATHOLIC</td>
<td style="text-align: right;">444</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">JEWISH</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">NONE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">387</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OTHER</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">BUDDHISM</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HINDUISM</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">OTHER EASTERN</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOSLEM/ISLAM</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">ORTHODOX-CHRISTIAN</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHRISTIAN</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NATIVE AMERICAN</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">INTER-NONDENOMINATIONAL</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Finally, you can use the <code>&lt;</code>, <code>&lt;=</code> etc. to compare a numeric variable to some value. For instance, this will return TRUE if <code>ft_dem</code>is greater than or equal to 50:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>ft_above_50 <span class="ot">=</span>  nes<span class="sc">$</span>ft_dem <span class="sc">&gt;=</span> <span class="dv">50</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Keep in mind that variables coded as TRUE and FALSE will get converted to 1 and 0 automatically when you try to do a math operation on them, so taking the mean from the variable above will essentially give us the proportion of respondents who gave a value greater than or equal to 50 on <code>ft_dem</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(nes<span class="sc">$</span>ft_above_50, <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6667805</code></pre>
</div>
</div>
</section>
<section id="changing-the-excluded-category-of-a-factor" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="changing-the-excluded-category-of-a-factor"><span class="header-section-number">3.6</span> Changing the excluded category of a factor</h2>
<p>Note here: when you use a factor variable inside a regression model, the first factor level will become the “excluded” category. If you want to change the excluded category, you can either reorder the levels using the code above, or you can just use the <code>relevel</code> function. For instance: in the original model, the excluded category are Democrats:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(obama_therm <span class="sc">~</span> pid_3, <span class="at">data=</span>nes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1)</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">85.306 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.554)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pid_3Ind</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29.574 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.804)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pid_3Rep</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-58.687 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.910)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5474&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.439&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>But I can change this so that “Independents” are the excluded category:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>pid_3_relevel <span class="ot">=</span> <span class="fu">relevel</span>(nes<span class="sc">$</span>pid_3, <span class="at">ref=</span><span class="st">"Ind"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(obama_therm <span class="sc">~</span> pid_3_relevel, <span class="at">data=</span>nes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1)</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">55.732 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.583)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pid_3_relevelDem</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">29.574 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.804)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">pid_3_relevelRep</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-29.113 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.928)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5474&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.439&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>The choice of excluded category shouldn’t really matter for the predicted outcomes from your model, but it does matter for how you interpret your results, so it often makes sense to choose an excluded category based on what seems easiest to interpret.</p>
</section>
</section>
<section id="formatting-output-for-the-final-paper" class="level1 page-columns page-full" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Formatting output for the final paper</h1>
<p>For your final paper, you should aim to have results that look professional and comprehensible to someone who isn’t already familiar with your data. This means a few things:</p>
<ul>
<li><p><strong>Formatting anything</strong> Variable names and levels should be changed to something descriptive and easy for a person to read. When you’re running your analysis, its fine to use abbreviations like “pid_3”, but when you’re presenting your results to someone else, you’ll want to change these to something like “Party ID (3-categories)”.</p></li>
<li><p><strong>Formatting plots</strong> Everything should have clear axis labels and tickmarks. (This part you will need to do in R.)</p>
<ul>
<li>They should also have a label (fig 1, or table 1) a descriptive title, and maybe even a caption if there are important details you want to communicate about your results. (You <em>can</em> handle these in R, but you could also just write it out in the text of the word document if that’s easier for you.)</li>
<li>Make sure you include a legend where necessary. Most often, this will be when you use shapes/colors/or line types to communicate important information in your plot.</li>
<li>Make sure you’ve adjusted the size of your plot so that important information is clearly visible.</li>
</ul></li>
<li><p><strong>Formatting tables and regression output</strong> Everything should be readable, which usually means you will want to align your output in a table or use a fixed-width font.</p>
<ul>
<li>Numbers should be rounded to a sensible number of digits. What constitutes “sensible” is partly a judgement call, but its unlikely that you’ll be showing anything informative beyond 3 digits after the decimal place.</li>
</ul></li>
</ul>

<div class="no-row-height column-margin column-container"><div class="">
<p>Avoid tables like the one below! Word processors use variable-width fonts, which means everything gets out of alignment if you just start typing numbers in:</p>
<p><img src="bad_table.png" class="img-fluid"></p>
<p>Instead, you should create a table in Word and then put values in it. Here’s the same information, except the values have been placed in a table and the variable names have been edited:</p>
<p><img src="good_table.png" class="img-fluid"></p>
</div></div><ul>
<li><strong>For regression output</strong> The notes about rounding and formatting apply here as well, but you should also think carefully about what you report. You should only include statistics that you needed to report for your prior homework, so you should <strong>not</strong> just copy and paste everything you see when you run <code>summary(model)</code>. Nobody needs to know the number of Fisher Scoring Iterations! That’s between you and R. Stick with the basics like the coefficients, fit statistic, p-values, etc.</li>
</ul>
<p>When in doubt, look at the table or plot you have created and ask yourself if it would make sense to someone who wasn’t already familiar with the data. If it doesn’t seem like it would be comprehensible, then you should look for ways to make it so.</p>
<section id="using-printc-to-format-tables-and-models" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="using-printc-to-format-tables-and-models"><span class="header-section-number">4.1</span> Using printC to format tables and models</h2>
<p>It turns out the <code>poliscidata</code> package includes a helper function that can make exporting your tables and regression model output a lot easier. The <code>printC()</code> package will take pretty much any output and store it in a file in your local directory called Table.Output.html. If you open this file, you can just copy-paste that table into a word document and then make additional modifications there. In some cases, this may be a bit easier than having to type everything out by hand. Note that every time you run this function, your table will be appended to the bottom of the resulting file, so if you run this five times, you’ll have five separate tables and you’ll have to be careful to make sure you copy the correct one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a frequency table of party ID</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>pid_freq <span class="ot">=</span> <span class="fu">freq</span>(nes<span class="sc">$</span>pid_3, <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">glm</span>(obama_win12  <span class="sc">~</span> secularism <span class="sc">+</span> gunlaw_rank, <span class="at">data=</span>states, <span class="at">family=</span>binomial) </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary output from a logistic regression: </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>model_summary <span class="ot">=</span> <span class="fu">summary</span>(model)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the odds ratios from the same logistic regression</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>orat <span class="ot">=</span> <span class="fu">orci</span>(model)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results in Table.Output</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">printC</span>(pid_freq)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results in Table.Output</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">printC</span>(model_summary)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results in Table.Output</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">printC</span>(orat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s what the Table.Output.html file looks like after running the above commands:</p>
<p><img src="html_tableoutput.png" class="img-fluid"></p>
<p>To reiterate: there’s still some edits I would want to make to each of these tables, but if I copy and paste one into a word document, at least some of the formatting and alignment will already be handled for me.</p>
<p>For whatever its worth: R has a wide variety of options for formatting output from regression tables and models. We looked at using the <a href="https://hughjonesd.github.io/huxtable/huxtable.html"><code>huxtable</code></a> package in a previous class, and most of the tables in this document were formatted using <a href="https://bookdown.org/yihui/rmarkdown-cookbook/kable.html"><code>knitr::kable()</code></a>. Either of these are fine options if you feel like going for style points, but they’re not required.</p>
</section>
<section id="exporting-plots-to-word" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="exporting-plots-to-word"><span class="header-section-number">4.2</span> Exporting plots to word</h2>
<p>By this point, everyone should have experience exporting plots to a word document by either copy-pasting or using the Rstudio export plot dialogue. However, in some cases you may need finer control over the size or resolution of your plot. The code below gives an example of creating a .png file in the current working directory with a specified height and width. Instead of showing up in the Rstudio plot window, this will cause the plot to be written to a file with the name you specify in the <code>filename</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this command sets up a file in the current working directory </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="st">"turnout_plot.png"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="fl">8.5</span>, <span class="at">units =</span> <span class="st">"in"</span>, <span class="co"># height and width, specified in inches</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>voted08_numeric <span class="ot">=</span> <span class="fu">as.numeric</span>(nes<span class="sc">$</span>voted2008 <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the plot that will be written to the file</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(voted08_numeric<span class="sc">*</span><span class="dv">100</span> <span class="sc">~</span> pid_x, <span class="co"># * 100 to scale the results as % </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"% voted in 2008"</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Party ID (7-categories)"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Voter turnout by party ID"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">connect =</span> <span class="cn">FALSE</span>, <span class="co"># change to TRUE to show a line connecting each point</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>nes) </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot is not written to file until this command runs: </span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="example-plots-and-tables" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Example plots and tables</h1>
<p>The following sections contain some examples of plots and tables you can use to summarize one or more variables. This is not an exhaustive list and the most appropriate visualization for your particular set of variables may not be included below. Most of this code will use either base R commands or it will use commands imported by the <code>poliscidata</code> package, so you would need to run <code>library(poliscidata)</code> before any of the code below would work. Also, for the sake of simplicity, I didn’t use weights for any of these plots, so this wouldn’t be the right way to handle these datasets normally, but it should work fine for your final analysis since that final survey also doesn’t have any weights with it!</p>
<p>Finally: there are lots of additional libraries that you could use instead, so don’t feel like you’re limited to the stuff in this section or even stuff that we’ve covered in class. R has been around a long time and has a vast user base, and its unlikely you’re the first person to need to make a visual representation of something. So feel free to get creative and look around online for code or packages that can give you what it is you’re looking for.</p>
<section id="plots-and-tables-for-a-single-variable" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="plots-and-tables-for-a-single-variable"><span class="header-section-number">5.1</span> Plots and tables for a single variable</h2>
<p>These are some functions you could use to either plot or create a table of summary statistics to show the central tendency, dispersion, skewness etc. for a single variable.</p>
<section id="freq" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="freq"><span class="header-section-number">5.1.1</span> freq</h3>
<p>The <code>freq</code> function should be used for categorical variables. It will generate both a frequency table and a barplot by default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gay_sup <span class="ot">=</span> <span class="fu">freq</span>(states<span class="sc">$</span>gay_support3, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>               <span class="co"># these options apply to the barplot</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y.axis=</span><span class="st">'percent'</span>,  <span class="co"># use a percent scale instead of frequency</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab=</span><span class="st">'percentage'</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab=</span><span class="st">"level of gay rights support in state"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>gay_sup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="2100"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<caption>level of gay rights support in state</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Frequency</th>
<th style="text-align: right;">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Low</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Med</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="histograms-or-density-plots" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="histograms-or-density-plots"><span class="header-section-number">5.1.2</span> histograms or density plots</h3>
<p>Histograms or density plots are a good option for a single continuous variable. <code>hist</code> will generate a histogram, and <code>plot(density(x))</code> will generate a kernel density plot (more or less a “smooth” equivalent of a histogram)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(states<span class="sc">$</span>prcapinc,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"per capita income"</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"histogram of state per capita income"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(states<span class="sc">$</span>prcapinc),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"per capita income"</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"density plot of state per capita income"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="describe" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="describe"><span class="header-section-number">5.1.3</span> describe</h3>
<p>The describe function will generally produce sensible summary statistics for one or more variables regardless of their type. If you specify a data set, you can use the formula syntax <code>~var1 + var2 +...</code> to get descriptive statistics for multiple variables from a single dataset in one step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>desc <span class="ot">=</span> <span class="fu">describe</span>(<span class="sc">~</span>hispanic04 <span class="sc">+</span> gb_win00,<span class="at">data=</span>states)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>desc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This command doesn’t offer a lot of options for formatting the results, but you could use the code below to make this create nice looking output that you could put in an appendix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>desc <span class="ot">=</span> <span class="fu">describe</span>(<span class="sc">~</span>hispanic04 <span class="sc">+</span> gb_win00,<span class="at">data=</span>states)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Hmisc<span class="sc">::</span><span class="fu">html</span>(desc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: &#808080;
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>

<title>hispanic04 + gb_win00 Descriptives</title>
<font color="MidnightBlue"><div align="center"><span style="font-weight:bold">hispanic04 + gb_win00 <br><br> 2  Variables   50  Observations</span></div></font>
<hr class="thinhr">
<span style="font-weight:bold">hispanic04</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAIgAAAANCAMAAABFGdYLAAAACVBMVEUAAADMzMz////1iUV5AAAAYElEQVQ4je2TMQoAMAgD1f8/upJSSK2lk9DBWwSzhMCJAgF+NJK8ShADs4gfiySvErpIF3kWWcbsKF3yh8Wi5FArU+2uHxJZa+wYXdqGR6PkmC2b8T4tki7SRZ5FfrFmANAPCZeLCd4vAAAAAElFTkSuQmCC" alt="image"></div>
<style>
 .hmisctable568197 {
 border: none;
 font-size: 74%;
 }
 .hmisctable568197 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable568197 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable568197">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th><th>.05</th><th>.10</th><th>.25</th><th>.50</th><th>.75</th><th>.90</th><th>.95</th></tr>
 <tr><td>50</td><td>0</td><td>45</td><td>1</td><td>8.812</td><td>9.012</td><td> 1.225</td><td> 1.880</td><td> 2.800</td><td> 5.750</td><td>10.100</td><td>19.470</td><td>31.630</td></tr>
 </tbody></table>

<span style="font-size: 85%;"><font color="MidnightBlue">lowest</font>&nbsp;: 0.8  0.9  1    1.5  1.7  ,  <font color="MidnightBlue">highest</font>: 22.8 28   34.6 34.7 43.3</span>
<hr class="thinhr">
<span style="font-weight:bold">gb_win00</span>
<style>
 .hmisctable241100 {
 border: none;
 font-size: 85%;
 }
 .hmisctable241100 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable241100 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable241100">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>50</td><td>0</td><td>2</td></tr>
 </tbody></table>

<pre style="font-size:85%;"> Value      Gore win Bush win
 Frequency        20       30
 Proportion      0.4      0.6 </pre>

<hr class="thinhr">
</div>
</div>
</section>
<section id="tableprop.table" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="tableprop.table"><span class="header-section-number">5.1.4</span> table/prop.table</h3>
<p>A simple and very flexible method for getting summary statistics for a categorical variable is the <code>table</code> command, which will produce a simple frequency table. You can use the <code>prop.table</code> function on an existing frequency table to get proportions instead of counts. You can also use the <code>barplot</code> command on any table to turn it into a barplot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(world<span class="sc">$</span>democ_regime, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">dnn=</span><span class="st">"democracy?"</span>) <span class="co"># dnn is the dimension name</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the default prop.table command will give a proportion between 0 and 1</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># multiplying by 100 will convert this to a %</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(world<span class="sc">$</span>democ_regime, <span class="at">dnn=</span><span class="st">"democracy?"</span>)) <span class="sc">*</span> <span class="dv">100</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">democratic.regime</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">91</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">democratic.regime</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">40.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">59.48</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="plots-for-multiple-variables" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="plots-for-multiple-variables"><span class="header-section-number">5.2</span> Plots for multiple variables</h2>
<p>Here are some plots for multiple variables that you might consider using. Note that at least some of these functions will allow you to include three or more variables, but you’ll need to be careful to make sure everything is clearly labelled and comprehensible when you do this because its pretty easy to end up with an unreadable plot.</p>
<section id="plotmeansc" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="plotmeansc"><span class="header-section-number">5.2.1</span> plotmeansC</h3>
<p>Plot the mean of an interval level dependent variable across different levels of a nominal or ordinal variable. The general syntax is <code>plotmeansC(data, ~y_var, ~x_var, y_var ~ x_var)</code> where <code>y_var</code> is an interval level dependent variable, and <code>x_var</code> is a categorical predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeansC</span>(nes, <span class="sc">~</span>obama_therm, <span class="sc">~</span>pid_3, obama_therm <span class="sc">~</span> pid_3, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"Party ID (3 categories)"</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="st">"Mean feeling thermometer for Barack Obama"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Obama feeling thermometer by party ID"</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="plotmeans" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="plotmeans"><span class="header-section-number">5.2.2</span> plotmeans</h3>
<p>Plotmeans will give you the average and the 95% confidence interval for a continuous variable at different levels of a factor variable. The example below uses a dichotomous variable for whether or not a person voted that has been recoded to a numeric dummy variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>nes<span class="sc">$</span>voted08_numeric <span class="ot">=</span> <span class="fu">as.numeric</span>(nes<span class="sc">$</span>voted2008 <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(voted08_numeric<span class="sc">*</span><span class="dv">100</span> <span class="sc">~</span> pid_x, <span class="co"># * 100 to scale the results as % </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"% voted in 2008"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Party ID (7-categories)"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Voter turnout by party ID"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">connect =</span> <span class="cn">FALSE</span>, <span class="co"># change to TRUE to show a line connecting each point</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>nes) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="compmeans" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="compmeans"><span class="header-section-number">5.2.3</span> compmeans</h3>
<p><code>compmeans</code> will create a table and a set of boxplots showing the values of a continuous variable at different levels of a factor. <code>x</code> should be a continuous variable, and <code>f</code> should be a factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">=</span> <span class="fu">compmeans</span>(<span class="at">x=</span> nes<span class="sc">$</span>obama_therm, <span class="at">f=</span> nes<span class="sc">$</span>pid_3, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">'Party ID (3-categories)'</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">"Obama Feeling thermometer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="2100"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Std. Dev.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dem</td>
<td style="text-align: right;">85.31</td>
<td style="text-align: right;">2197</td>
<td style="text-align: right;">19.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ind</td>
<td style="text-align: right;">55.73</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;">31.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rep</td>
<td style="text-align: right;">26.62</td>
<td style="text-align: right;">1293</td>
<td style="text-align: right;">26.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">60.72</td>
<td style="text-align: right;">5474</td>
<td style="text-align: right;">34.64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="boxplot-stripchart" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="boxplot-stripchart"><span class="header-section-number">5.2.4</span> boxplot + stripchart</h3>
<p>Both the <code>boxplot</code> and the <code>stripchart</code> function will allow you to use formula syntax to show the relationship between a continuous IV and one or more categorical DVs. Combining the two plot types is a nice way to give a good sense of the overall distribution of a continuous variable.</p>
<p>The <code>method="jitter"</code> argument basically just adds a small amount of “noise” to the data to avoid points from showing up right on top of each other, which is especially useful when you have a lot of observations that have the same value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draws a box plot with points representing actual observations</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(union10 <span class="sc">~</span> region, <span class="at">data=</span>states, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Region"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Percent Unionized"</span>, </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Unionization, by Region"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">'lightgreen'</span> <span class="co"># color</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(union10 <span class="sc">~</span> region, <span class="at">data=</span>states,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">'gold'</span>, <span class="co"># controls the color</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">pch =</span> <span class="dv">20</span>, <span class="co"># controls the point type</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">vertical=</span><span class="cn">TRUE</span>,  </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">method=</span><span class="st">"jitter"</span>,  <span class="co"># prevents overplotting</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">add =</span> <span class="cn">TRUE</span> <span class="co"># add = TRUE adds this to the current plot </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="crosstab" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="crosstab"><span class="header-section-number">5.2.5</span> crosstab</h3>
<p>The <code>crosstab</code> function creates a two-way table for two categorical variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">=</span> <span class="fu">crosstab</span>( <span class="at">dep=</span> world<span class="sc">$</span>protact3 ,  <span class="co"># the dependent variable</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">indep=</span> world<span class="sc">$</span>dem_level4,  <span class="co"># the independent variable</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">prop.c=</span>T, <span class="co"># if the IV is in the rows, get row percent. If its in the columns, get column percents</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">plot=</span><span class="cn">FALSE</span>,  <span class="co"># if you change this to TRUE, you'll get a mosaic plot as well as the table</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Protest activity"</span>, <span class="st">"Level of democracy"</span>) <span class="co"># dependent varname followed by indep varname</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>               )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<table data-quarto-postprocess="true" data-border="1" class="table">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th"></td>
<td data-quarto-table-cell-role="th">Protest activity</td>
<td data-quarto-table-cell-role="th">Full Democ</td>
<td data-quarto-table-cell-role="th">Part Democ</td>
<td data-quarto-table-cell-role="th">Hybrid</td>
<td data-quarto-table-cell-role="th">Authoritarian</td>
<td data-quarto-table-cell-role="th">Total</td>
</tr>
<tr class="even">
<td>1</td>
<td>Low</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: right;">0.0%</td>
<td style="text-align: right;">42.3%</td>
<td style="text-align: right;">44.4%</td>
<td style="text-align: right;">62.5%</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>3</td>
<td>Moderate</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: right;">31.6%</td>
<td style="text-align: right;">38.5%</td>
<td style="text-align: right;">33.3%</td>
<td style="text-align: right;">37.5%</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>5</td>
<td>High</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: right;">68.4%</td>
<td style="text-align: right;">19.2%</td>
<td style="text-align: right;">22.2%</td>
<td style="text-align: right;">0.0%</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>7</td>
<td>Total</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: right;">30.6%</td>
<td style="text-align: right;">41.9%</td>
<td style="text-align: right;">14.5%</td>
<td style="text-align: right;">12.9%</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>




<p>You could also use the proportions from this function to create a barplot that shows the proportion of your IV at different levels of your dependent variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ct<span class="sc">$</span>prop.col <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># scale to a percentage</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"% of group"</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"level of democracy"</span> ,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adds a legend</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text=</span><span class="cn">TRUE</span>, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add a title to the legend and place at the bottom</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">args.legend=</span><span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Level of protest activity"</span>, <span class="at">x=</span><span class="st">'bottom'</span>) ,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"level of protest activity by level of democracy"</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="3000"></p>
</div>
</div>
</section>
</section>
</section>
<section id="interpreting-logistic-regression-models" class="level1 page-columns page-full" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Interpreting logistic regression models</h1>
<p>This section has a quick refresher on interpreting logistic regression output.</p>
<p>I’ll use the following logistic regression model:</p>
<p>The dependent variable is whether Obama won a state in 2012. The independent variables are % unionized in 2010, and whether a state is in the south.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>states_model <span class="ot">=</span> <span class="fu">glm</span>(obama_win12 <span class="sc">~</span> union10 <span class="sc">+</span> abort_rank3 <span class="sc">+</span> south, <span class="at">data=</span>states, <span class="at">family=</span>binomial) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-coefficients" class="level3 page-columns page-full" data-number="6.0.1">
<h3 data-number="6.0.1" class="anchored" data-anchor-id="model-coefficients"><span class="header-section-number">6.0.1</span> Model Coefficients</h3>
<p>Remember that the logistic model predicts the effect of a one unit change in X on the log odds ratio that Y=1. The logistic regression output can give us a sense of the direction of effect, and the statistical significance for each coefficient, but interpreting the substantive implications of our results will usually require us to convert the logit coefficients into something more sensible like an odds ratio or a predicted probability.</p>
<div class="cell page-columns page-full">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">

<table>
<thead>
<tr>
<th style="text-align:right;">
Probability: <span class="math inline">\(p\)</span>
</th>
<th style="text-align:right;">
odds ratio: <span class="math inline">\(p / (1-p)\)</span>
</th>
<th style="text-align:right;">
logged odds ratio: <span class="math inline">\(log(p/ (1-p))\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-5
</td>
</tr>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
-4
</td>
</tr>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
-2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0.73
</td>
<td style="text-align:right;">
2.72
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.88
</td>
<td style="text-align:right;">
7.39
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
20.09
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
54.60
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
148.41
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>

</table>
<p>Probabilities, Odds ratios, and logged odds ratios</p>
</div></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(states_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1)</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-3.022 *</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1.191)&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">union10</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.202 *</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.098)&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">abort_rank3Mid</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.343&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.883)&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">abort_rank3Less restr</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.944&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1.143)&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">southSouth</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.507&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.874)&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="2" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>

</div>
</div>
<p>Based on these results, we can see that % unionization had a positive effect and statistically significant effect on the chances that Obama would win a state in 2012, but we would probably just want to convert these to odds ratios before going beyond that.</p>
</section>
<section id="exponentiation-and-odds-ratios" class="level3 page-columns page-full" data-number="6.0.2">
<h3 data-number="6.0.2" class="anchored" data-anchor-id="exponentiation-and-odds-ratios"><span class="header-section-number">6.0.2</span> Exponentiation and odds ratios</h3>
<p>The logit model coefficients represent the effect of a one unit change in X on the log odds that Y=1. For ease of interpretation, we generally want to convert logged odds ratios to standard odds ratios. The <code>orci</code> function will do that for us (and also calculate a 95% confidence interval around the odds ratio).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">orci</span>(states_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">OddsRatio</th>
<th style="text-align: right;">2.5 %</th>
<th style="text-align: right;">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.433</td>
</tr>
<tr class="even">
<td style="text-align: left;">union10</td>
<td style="text-align: right;">1.224</td>
<td style="text-align: right;">1.019</td>
<td style="text-align: right;">1.508</td>
</tr>
<tr class="odd">
<td style="text-align: left;">abort_rank3Mid</td>
<td style="text-align: right;">3.831</td>
<td style="text-align: right;">0.715</td>
<td style="text-align: right;">24.819</td>
</tr>
<tr class="even">
<td style="text-align: left;">abort_rank3Less restr</td>
<td style="text-align: right;">6.985</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">80.711</td>
</tr>
<tr class="odd">
<td style="text-align: left;">southSouth</td>
<td style="text-align: right;">0.602</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">3.422</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Another way to interpret these results is to convert them to a percentage change in the odds that Y=1. To calculate that, you can just take:</p>
<p><span class="math display">\[(e^\beta -1) \times 100\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>In plain English: that’s the exponentiated logit coefficient minus 1, multiplied by 100.</p>
</div></div><p>For instance:</p>
<ul>
<li><p>the coefficient on <code>union10</code> is 1.224. So: <span class="math inline">\((1.224 - 1) \times 100 = 22.4\)</span>: a one unit change in the level of unionization in a state leads to a 22.4% increase in the odds of Obama winning that state in 2012 (after controlling for abortion restrictions and region)</p></li>
<li><p>The coefficient on <code>south</code> is 0.602, so <span class="math inline">\((0.602-1) \times 100 = -39.8\)</span>: the odds of Obama winning a southern state were 39.8% lower than the odds of him winning in a non-southern state (after controlling for unionization and abortion restrictions)</p></li>
</ul>
<p>You can get this result for the entire set of model coefficients in one step:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">orci</span>(states_model) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">OddsRatio</th>
<th style="text-align: right;">2.5 %</th>
<th style="text-align: right;">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-95.1</td>
<td style="text-align: right;">-99.6</td>
<td style="text-align: right;">-56.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">union10</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">50.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">abort_rank3Mid</td>
<td style="text-align: right;">283.1</td>
<td style="text-align: right;">-28.5</td>
<td style="text-align: right;">2381.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">abort_rank3Less restr</td>
<td style="text-align: right;">598.5</td>
<td style="text-align: right;">-20.2</td>
<td style="text-align: right;">7971.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">southSouth</td>
<td style="text-align: right;">-39.8</td>
<td style="text-align: right;">-89.6</td>
<td style="text-align: right;">242.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="predicted-probabilities" class="level3 page-columns page-full" data-number="6.0.3">
<h3 data-number="6.0.3" class="anchored" data-anchor-id="predicted-probabilities"><span class="header-section-number">6.0.3</span> Predicted probabilities</h3>
<p>Another way to interpret these results is to get predicted probabilities at different values of the independent variable. We can do this by taking the <strong>linear prediction</strong> for a particular observation, and then using the inverse logit function to convert the logged odds ratio into a probability.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>linear prediction</strong> in this sense just means we’re getting predictions using the same approach we use to get predictions from a linear model:</p>
<p><span class="math display">\[{\text{linear prediction of Y}} = \beta_0 + \beta_1X_1 + \beta_2X_2...\]</span></p>
<p>In other words: we multiply the values of X by their respective coefficients and then add the intercept term. Once we have our linear prediction for Y, we can turn it into a predicted probability using the inverse logit function, which is just:</p>
<p><span class="math display">\[\frac{1}{[1+e^{-(\text{linear prediction of Y})}]}\]</span></p>
<p>We could do at least some of this calculation by hand or using a calculator, but the predict function in R basically does this for us. If we use <code>predict(model, type='link')</code>, we get the linear predictor. And if we use <code>predict(model, type='response')</code>, R will convert the linear predictor to a predicted probability.</p>
</div></div><p>For instance: I could calculate the predicted probability for a state with 20% unionization, in the South, with the minimum level of abortion restrictions by plugging those values into the regression results and then using the <code>inverse.logit</code> function in R:</p>
<p>Here are those coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(states_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-3.0219322</td>
</tr>
<tr class="even">
<td style="text-align: left;">union10</td>
<td style="text-align: right;">0.2022486</td>
</tr>
<tr class="odd">
<td style="text-align: left;">abort_rank3Mid</td>
<td style="text-align: right;">1.3430677</td>
</tr>
<tr class="even">
<td style="text-align: left;">abort_rank3Less restr</td>
<td style="text-align: right;">1.9437812</td>
</tr>
<tr class="odd">
<td style="text-align: left;">southSouth</td>
<td style="text-align: right;">-0.5068546</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And now we can just plug in the relevant values of each variable and then transform the result to a probability:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept + union10_coef * 20 +  abortrank3Mid * 0 + abort_rank3Less restr * 1 + southSouth  * 1</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>linear_pred <span class="ot">=</span>  <span class="sc">-</span><span class="fl">3.0219322</span> <span class="sc">+</span>  <span class="fl">0.2022486</span> <span class="sc">*</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">1.9437812</span> <span class="sc">+</span>   <span class="sc">-</span><span class="fl">0.5068546</span>  </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">inverse.logit</span>(linear_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9212872</code></pre>
</div>
</div>
<p>This translates to a 92% chance that Obama would win the state under those conditions.</p>
<p>Alternatively, I could generate this prediction by creating some data with these values, and then using the <code>predict</code> function with the newdata option:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a single row of data with the specified values: </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>state_case <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">union10 =</span> <span class="dv">20</span>,  </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">abort_rank3 =</span> <span class="st">"Less restr"</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">south =</span> <span class="st">"South"</span> )</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(states_model, <span class="at">newdata=</span> state_case, <span class="at">type=</span><span class="st">'response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.9212872 </code></pre>
</div>
</div>
<p>(notice this is the same result!)</p>
<p>And now here’s what happens when I go from <code>abort_rank3 = "Less restr"</code> to <code>abort_rank3 =  "Mid"</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a single row of data with the specified values: </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>state_case <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">union10 =</span> <span class="dv">20</span>,  </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">abort_rank3 =</span> <span class="st">"Mid"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">south =</span> <span class="st">"South"</span> )</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(states_model, <span class="at">newdata=</span> state_case, <span class="at">type=</span><span class="st">'response'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.8652097 </code></pre>
</div>
</div>
<p>Finally, to calculate a 95% confidence interval around this predicted probability, I need to start by calculating a 95% confidence interval on the linear predictor <strong>before</strong> I convert the result back to a probability, that’s why I want to use <code>predict(model, type='link')</code> here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-39"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-39-1"><a href="#annotated-cell-39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predictor on the log odds scale </span></span>
<span id="annotated-cell-39-2"><a href="#annotated-cell-39-2" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(states_model, <span class="at">newdata=</span> state_case, <span class="at">type=</span><span class="st">'link'</span>, <span class="at">se.fit=</span>T)</span>
<span id="annotated-cell-39-3"><a href="#annotated-cell-39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-39-4"><a href="#annotated-cell-39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-39-5"><a href="#annotated-cell-39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The predictions: </span></span>
<span id="annotated-cell-39-6"><a href="#annotated-cell-39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-39-7"><a href="#annotated-cell-39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">"prediction"</span> <span class="ot">=</span> <span class="fu">inverse.logit</span>(preds<span class="sc">$</span>fit),</span>
<span id="annotated-cell-39-8"><a href="#annotated-cell-39-8" aria-hidden="true" tabindex="-1"></a>           <span class="co"># the lower 95% confidence interval</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-39" data-target-annotation="1">1</button><span id="annotated-cell-39-9" class="code-annotation-target"><a href="#annotated-cell-39-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"lwr"</span> <span class="ot">=</span> <span class="fu">inverse.logit</span>(preds<span class="sc">$</span>fit <span class="sc">-</span>  <span class="fl">1.96</span> <span class="sc">*</span> preds<span class="sc">$</span>se.fit),</span>
<span id="annotated-cell-39-10"><a href="#annotated-cell-39-10" aria-hidden="true" tabindex="-1"></a>           <span class="co"># the upper 95% confidence interval</span></span>
<span id="annotated-cell-39-11"><a href="#annotated-cell-39-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"upr"</span> <span class="ot">=</span> <span class="fu">inverse.logit</span>(preds<span class="sc">$</span>fit<span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> preds<span class="sc">$</span>se.fit)</span>
<span id="annotated-cell-39-12"><a href="#annotated-cell-39-12" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-39" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-39" data-code-annotation="1" data-code-lines="9,11">Remember that, according to the central limit theorem, approximately 95% of sample means will fall within about 1.96 standard errors of the population mean. So we calculate the upper and lower confidence interval for this estimate by <span class="math display">\[ \bar{x} \pm  1.96 \times \sigma\]</span></span>
</dd>
</dl>
</div>
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">prediction</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">lwr</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">upr</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.865</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.303</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.99</td></tr>
</tbody></table>

</div>
</div>
<p>This is last part (along with some reformatting of the results) is really all the <code>pred_ci</code> function is meant to do, so these should work more-or-less interchangibly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the function: </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'https://raw.githubusercontent.com/Neilblund/APAN/main/pred_ci.R'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pred_ci</span>(states_model, <span class="at">newdata=</span>state_case)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="huxtable" data-quarto-disable-processing="true" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  ">
<colgroup><col><col><col><col><col><col><col></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">index</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">union10</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">abort_rank3</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">south</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">fit</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">lwr</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">upr</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Mid</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">South</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.865</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.303</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.99</td></tr>
</tbody></table>

</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Marginal effects
</div>
</div>
<div class="callout-body-container callout-body">
<p>You don’t actually need this for your paper, but I just wanted to briefly mention that the other approach to interpretation is to calculate some kind of marginal effect on the predicted probabilities. These are annoying to create but intuitive to interpret: they represent the effect of a one unit change in the independent variable on the predicted probability that <span class="math inline">\(Y=1\)</span>. Since the predicted probability curve is not linear, the marginal effect will be different depending on what values to choose to compare, which leaves a lot of room for disagreement among researchers regarding what cases they should compare when calculating a marginal effect. <a href="#marginal-effects-1">There’s a section at the end of this document</a> that demonstrates one method to calculating this, check it out if you’re interested, but again: this is not required for the final paper.</p>
</div>
</div>
</section>
<section id="assessing-model-fit" class="level3" data-number="6.0.4">
<h3 data-number="6.0.4" class="anchored" data-anchor-id="assessing-model-fit"><span class="header-section-number">6.0.4</span> Assessing model fit</h3>
<p>For linear regression, we might use the <span class="math inline">\(R^2\)</span> or adjusted <span class="math inline">\(R^2\)</span> value to assess model fit, but the assumptions that allow us to estimate the residual sum of squares don’t hold up for this type of model. Instead, we can use the <code>logregR2()</code> function to produce some alternatives to the <span class="math inline">\(R^2\)</span> (aptly referred to as “pseudo R-squared”) statistics that will work this type of model. The Cox and Snell Index, Nagelkerke Index, and McFadden’s R2 are all slight variations on general idea of comparing your model to a version of your model without any parameters (an intercept-only model). They can give you a very general sense of how well the model fits the data, but they aren’t exactly like the true R-squared statistic and you’ll notice that the three metrics give somewhat different results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logregR2</span>(states_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi2                 24.812 
Df                   4 
Sig.                 &lt;.001 
Cox and Snell Index  0.391 
Nagelkerke Index     0.522 
McFadden's R2        0.358 </code></pre>
</div>
</div>
</section>
</section>
<section id="plots-for-predicted-probabilities" class="level1 page-columns page-full" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Plots for predicted probabilities</h1>
<p>The following sections discuss options for plotting predicted probabilities generated by a logistic regression model.</p>
<section id="using-the-pred_ci-function" class="level2 page-columns page-full" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="using-the-pred_ci-function"><span class="header-section-number">7.1</span> Using the pred_ci function</h2>
<p>If you run the code below, you should see the <code>pred_ci</code> function pop up in your global environment (you could also just go to the link and copy-paste it into your script).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the function: </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'https://raw.githubusercontent.com/Neilblund/APAN/main/pred_ci.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s an example of using <code>pred_ci</code> to get predictions and confidence interval from a model that predicts the % chance of Obama winning a state in 2012 based on the level of unionization, level of statewide abortion restrictions, and whether a state is in the south. After estimating our model, we use the <code>expand.grid</code> function to create a data frame with hypothetical states, and then we pass both the model and the new data object to the <code>pred_ci</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-43"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-43-1"><a href="#annotated-cell-43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poliscidata)</span>
<span id="annotated-cell-43-2"><a href="#annotated-cell-43-2" aria-hidden="true" tabindex="-1"></a>states_model <span class="ot">=</span> <span class="fu">glm</span>(obama_win12 <span class="sc">~</span> union10 <span class="sc">+</span> abort_rank3 <span class="sc">+</span> south, <span class="at">data=</span>states, <span class="at">family=</span>binomial) </span>
<span id="annotated-cell-43-3"><a href="#annotated-cell-43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create some fake states </span></span>
<span id="annotated-cell-43-4"><a href="#annotated-cell-43-4" aria-hidden="true" tabindex="-1"></a>state_cases <span class="ot">=</span> <span class="fu">expand.grid</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="1">1</button><span id="annotated-cell-43-5" class="code-annotation-target"><a href="#annotated-cell-43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">abort_rank3 =</span> <span class="fu">c</span>(<span class="st">"More restr"</span>, <span class="st">"Mid"</span>, <span class="st">"Less restr"</span>),</span>
<span id="annotated-cell-43-6"><a href="#annotated-cell-43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">c</span>(<span class="st">"South"</span> , <span class="st">"Nonsouth"</span>),</span>
<span id="annotated-cell-43-7"><a href="#annotated-cell-43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">union10 =</span> <span class="fu">mean</span>(states<span class="sc">$</span>union10)</span>
<span id="annotated-cell-43-8"><a href="#annotated-cell-43-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-43-9"><a href="#annotated-cell-43-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-43-10"><a href="#annotated-cell-43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># use the pred_ci function  with the same syntax you would use for predict(). </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="2">2</button><span id="annotated-cell-43-11" class="code-annotation-target"><a href="#annotated-cell-43-11" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">pred_ci</span>(<span class="at">model =</span> states_model, <span class="at">newdata=</span>state_cases)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-43" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-annotation="1" data-code-lines="5,6,7">Notice we have all three levels of abort_rank3 and south here, but union10 is being held at its mean. So our predicted probabilities are based on six hypothetical “typical” states with average levels of unionization but differing values for abortion restrictions and south.</span>
</dd>
<dt data-target-cell="annotated-cell-43" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-annotation="2" data-code-lines="11">The syntax here is the same as the standard predict function, but we don’t need to specify <code>type="response"</code> and we don’t need to ask for the standard errors.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">index</th>
<th style="text-align: left;">abort_rank3</th>
<th style="text-align: left;">south</th>
<th style="text-align: right;">union10</th>
<th style="text-align: right;">fit</th>
<th style="text-align: right;">lwr</th>
<th style="text-align: right;">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">More restr</td>
<td style="text-align: left;">South</td>
<td style="text-align: right;">11.358</td>
<td style="text-align: right;">0.2258932</td>
<td style="text-align: right;">0.0394605</td>
<td style="text-align: right;">0.6745637</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Mid</td>
<td style="text-align: left;">South</td>
<td style="text-align: right;">11.358</td>
<td style="text-align: right;">0.5278262</td>
<td style="text-align: right;">0.1907047</td>
<td style="text-align: right;">0.8413460</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Less restr</td>
<td style="text-align: left;">South</td>
<td style="text-align: right;">11.358</td>
<td style="text-align: right;">0.6708724</td>
<td style="text-align: right;">0.1966546</td>
<td style="text-align: right;">0.9443599</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">More restr</td>
<td style="text-align: left;">Nonsouth</td>
<td style="text-align: right;">11.358</td>
<td style="text-align: right;">0.3263384</td>
<td style="text-align: right;">0.1030508</td>
<td style="text-align: right;">0.6713266</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Mid</td>
<td style="text-align: left;">Nonsouth</td>
<td style="text-align: right;">11.358</td>
<td style="text-align: right;">0.6498260</td>
<td style="text-align: right;">0.3420087</td>
<td style="text-align: right;">0.8688586</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Less restr</td>
<td style="text-align: left;">Nonsouth</td>
<td style="text-align: right;">11.358</td>
<td style="text-align: right;">0.7718854</td>
<td style="text-align: right;">0.3891260</td>
<td style="text-align: right;">0.9472982</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>The <code>fit</code> column contains the predicted probability of <span class="math inline">\(Y=1\)</span> for each case. <code>lwr</code> is the lower boundary of the 95% confidence interval for that prediction, and <code>upr</code> is the upper boundary of the 95% confidence interval for that prediction.</p>
</div></div></section>
<section id="logit-with-categorical-ivs" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="logit-with-categorical-ivs"><span class="header-section-number">7.2</span> Logit with categorical IVs</h2>
<p>The following sections show a couple of different options for plotting predicted probabilities and 95% confidence intervals from a logistic regression model at different levels of categorical variables.</p>
<section id="generating-the-predictions" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="generating-the-predictions"><span class="header-section-number">7.2.1</span> Generating the predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-44"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-44-1"><a href="#annotated-cell-44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create some fake states </span></span>
<span id="annotated-cell-44-2"><a href="#annotated-cell-44-2" aria-hidden="true" tabindex="-1"></a>state_cases <span class="ot">=</span> <span class="fu">expand.grid</span>(</span>
<span id="annotated-cell-44-3"><a href="#annotated-cell-44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">abort_rank3 =</span> <span class="fu">c</span>(<span class="st">"More restr"</span>, <span class="st">"Mid"</span>, <span class="st">"Less restr"</span>),</span>
<span id="annotated-cell-44-4"><a href="#annotated-cell-44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">c</span>(<span class="st">"South"</span> , <span class="st">"Nonsouth"</span>),</span>
<span id="annotated-cell-44-5"><a href="#annotated-cell-44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">union10 =</span> <span class="fu">mean</span>(states<span class="sc">$</span>union10)</span>
<span id="annotated-cell-44-6"><a href="#annotated-cell-44-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-44-7"><a href="#annotated-cell-44-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-44-8"><a href="#annotated-cell-44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use the pred_ci function  with the same syntax you would use for predict(). </span></span>
<span id="annotated-cell-44-9"><a href="#annotated-cell-44-9" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">pred_ci</span>(<span class="at">model =</span> states_model, <span class="at">newdata=</span>state_cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-plot" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="using-plot"><span class="header-section-number">7.2.2</span> Using plot()</h3>
<p>This is the same code we’ve practiced before. We start by plotting the predicted probabilities with the <code>plot()</code> function, then we add line segments to indicate the confidence intervals around each predicted probability with <code>segments()</code>. Then we add the <code>axis</code> labels across the bottom. Finally, we add a y-axis on the left hand side.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-45"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-45-1"><a href="#annotated-cell-45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># start with a plot of the predict probability (fit)</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="1">1</button><span id="annotated-cell-45-2" class="code-annotation-target"><a href="#annotated-cell-45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(preds),</span>
<span id="annotated-cell-45-3"><a href="#annotated-cell-45-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y=</span>preds<span class="sc">$</span>fit, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">axes=</span>F,</span>
<span id="annotated-cell-45-4"><a href="#annotated-cell-45-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Abortion restrictions/Region"</span>,</span>
<span id="annotated-cell-45-5"><a href="#annotated-cell-45-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Probability of Obama win in 2012"</span>,</span>
<span id="annotated-cell-45-6"><a href="#annotated-cell-45-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Probability of Obama winning state</span><span class="sc">\n</span></span>
<span id="annotated-cell-45-7"><a href="#annotated-cell-45-7" aria-hidden="true" tabindex="-1"></a><span class="st">           by region and abortion restriction ranking"</span>)</span>
<span id="annotated-cell-45-8"><a href="#annotated-cell-45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add a line segment to indicate the upper and lower CI boundary</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="2">2</button><span id="annotated-cell-45-9" class="code-annotation-target"><a href="#annotated-cell-45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(preds),</span>
<span id="annotated-cell-45-10"><a href="#annotated-cell-45-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y0 =</span> preds<span class="sc">$</span>lwr, </span>
<span id="annotated-cell-45-11"><a href="#annotated-cell-45-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">y1=</span>preds<span class="sc">$</span>upr)</span>
<span id="annotated-cell-45-12"><a href="#annotated-cell-45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-45-13"><a href="#annotated-cell-45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add the x axis labels</span></span>
<span id="annotated-cell-45-14"><a href="#annotated-cell-45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(preds),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="3">3</button><span id="annotated-cell-45-15" class="code-annotation-target"><a href="#annotated-cell-45-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"High restrictions/South"</span>, <span class="st">"Medium Restrictions/South"</span>,</span>
<span id="annotated-cell-45-16"><a href="#annotated-cell-45-16" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Low restrictions/South"</span>, <span class="st">"High restrictions/Nonsouth"</span>,</span>
<span id="annotated-cell-45-17"><a href="#annotated-cell-45-17" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Medium Restrictions/Nonsouth"</span>, <span class="st">"Low restrictions/Nonsouth"</span>),</span>
<span id="annotated-cell-45-18"><a href="#annotated-cell-45-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis=</span>.<span class="dv">7</span>)</span>
<span id="annotated-cell-45-19"><a href="#annotated-cell-45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add a y axis</span></span>
<span id="annotated-cell-45-20"><a href="#annotated-cell-45-20" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">las=</span><span class="dv">2</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-45" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-annotation="1" data-code-lines="2"><code>nrow()</code> counts the number of rows in a data frame. So the expression here just tells R to count from 1 to 6</span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-annotation="2" data-code-lines="9"><code>segments()</code> draws a line segment between the points specified by x0, y0 and x1, y1. However, since we just need a straight vertical line here, we don’t need to bother with specifying a value for x1.</span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-annotation="3" data-code-lines="15,16,17">As always, make sure that your labels are in the same order as your data. If you’re unsure, trying running <code>View(preds)</code> and double-checking.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/plot_simple-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<section id="same-plot-with-color-coding" class="level4" data-number="7.2.2.1">
<h4 data-number="7.2.2.1" class="anchored" data-anchor-id="same-plot-with-color-coding"><span class="header-section-number">7.2.2.1</span> Same plot with color-coding</h4>
<p>We can make this a little fancier (and/or more readable) by changing up how we display the axes. Instead of having all six cases separately on our x-axis, we can use color-coding to indicate region. This gives us a slightly more compact representation for our results. We’ll use the same model and predictions that we created in the previous section.</p>
<p>Much of the code here is unchanged. The main difference is that we have used <code>subset</code> to create separate predictions for Southern and Non-southern states, and then we’ve plotted the <code>points</code> and <code>segments</code> separately for each subgroup. The other difference has to do with the way we handled the axes: when we called <code>plot</code> we set <code>xlimit = c(.9, 3.1)</code>. That gave us three ticks with just a little extra space left over. Then, when we created the points and segments for the Southern states, we set <code>x=1:3+.05</code> and when we created the points and segments for the Non-southern states, we set <code>x=1:3-.05</code>. Adding this small offset to the x positioning allows us to show the south and non-south predictions close to each other without having them overlap.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-46"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-46-1"><a href="#annotated-cell-46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use subset to get separate predictions for each region: </span></span>
<span id="annotated-cell-46-2"><a href="#annotated-cell-46-2" aria-hidden="true" tabindex="-1"></a>south_preds  <span class="ot">=</span> <span class="fu">subset</span>(preds, south<span class="sc">==</span><span class="st">"South"</span>)</span>
<span id="annotated-cell-46-3"><a href="#annotated-cell-46-3" aria-hidden="true" tabindex="-1"></a>nonsouth_preds <span class="ot">=</span> <span class="fu">subset</span>(preds, south<span class="sc">==</span><span class="st">"Nonsouth"</span>)</span>
<span id="annotated-cell-46-4"><a href="#annotated-cell-46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make an empty plotting space</span></span>
<span id="annotated-cell-46-5"><a href="#annotated-cell-46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="1">1</button><span id="annotated-cell-46-6" class="code-annotation-target"><a href="#annotated-cell-46-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(.<span class="dv">9</span>, <span class="fl">3.1</span>),</span>
<span id="annotated-cell-46-7"><a href="#annotated-cell-46-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span>F, </span>
<span id="annotated-cell-46-8"><a href="#annotated-cell-46-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Abortion restrictions"</span>, <span class="at">ylab =</span> <span class="st">"Probability of Obama win in 2012"</span>,</span>
<span id="annotated-cell-46-9"><a href="#annotated-cell-46-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Probability of Obama win</span><span class="sc">\n</span><span class="st">by region and abortion restrictions"</span>)</span>
<span id="annotated-cell-46-10"><a href="#annotated-cell-46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence intervals: </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="2">2</button><span id="annotated-cell-46-11" class="code-annotation-target"><a href="#annotated-cell-46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="fl">-.05</span>, <span class="at">y0=</span>south_preds<span class="sc">$</span>lwr, <span class="at">y1=</span>south_preds<span class="sc">$</span>upr)</span>
<span id="annotated-cell-46-12"><a href="#annotated-cell-46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># segments for non-south</span></span>
<span id="annotated-cell-46-13"><a href="#annotated-cell-46-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="fl">+.05</span>, <span class="at">y0=</span>nonsouth_preds<span class="sc">$</span>lwr, <span class="at">y1=</span>nonsouth_preds<span class="sc">$</span>upr)</span>
<span id="annotated-cell-46-14"><a href="#annotated-cell-46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The prediction for south</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="3">3</button><span id="annotated-cell-46-15" class="code-annotation-target"><a href="#annotated-cell-46-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="fl">-.05</span>,<span class="at">y=</span>south_preds<span class="sc">$</span>fit, <span class="at">pch=</span><span class="dv">17</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,<span class="at">col =</span> <span class="st">"#e21833"</span>)</span>
<span id="annotated-cell-46-16"><a href="#annotated-cell-46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The prediction for nonsouth</span></span>
<span id="annotated-cell-46-17"><a href="#annotated-cell-46-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="fl">+.05</span>,<span class="at">y=</span>nonsouth_preds<span class="sc">$</span>fit, <span class="at">pch=</span><span class="dv">18</span>, <span class="at">cex =</span> <span class="dv">2</span>,<span class="at">col =</span> <span class="st">"#ffd200"</span>)</span>
<span id="annotated-cell-46-18"><a href="#annotated-cell-46-18" aria-hidden="true" tabindex="-1"></a><span class="co"># add the axes and the labels </span></span>
<span id="annotated-cell-46-19"><a href="#annotated-cell-46-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="annotated-cell-46-20"><a href="#annotated-cell-46-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"High restrictions"</span>, <span class="st">"Medium Restrictions"</span>, <span class="st">"Low restrictions"</span>), </span>
<span id="annotated-cell-46-21"><a href="#annotated-cell-46-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis=</span>.<span class="dv">7</span>)</span>
<span id="annotated-cell-46-22"><a href="#annotated-cell-46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend at the bottom</span></span>
<span id="annotated-cell-46-23"><a href="#annotated-cell-46-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottom"</span>, <span class="at">cex =</span>.<span class="dv">8</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">17</span>,<span class="dv">18</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#e21833"</span>, <span class="st">"#ffd200"</span>),</span>
<span id="annotated-cell-46-24"><a href="#annotated-cell-46-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"South"</span>, <span class="st">"Nonsouth"</span>))</span>
<span id="annotated-cell-46-25"><a href="#annotated-cell-46-25" aria-hidden="true" tabindex="-1"></a><span class="co"># add the y-axis</span></span>
<span id="annotated-cell-46-26"><a href="#annotated-cell-46-26" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">las=</span><span class="dv">2</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-46" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-46" data-code-annotation="1" data-code-lines="6">Setting <code>xlim= c(.9, 3.1)</code> gives us <strong>just</strong> enough space for three points, but with a little excess room so we can accommodate having two points side by side.</span>
</dd>
<dt data-target-cell="annotated-cell-46" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-46" data-code-annotation="2" data-code-lines="11,13">Notice the offsets of +.05 and -.05</span>
</dd>
<dt data-target-cell="annotated-cell-46" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-46" data-code-annotation="3" data-code-lines="15,17">The <code>col="#e21833"</code> and <code>col="#ffd200"</code> give us Maryland Red and gold, respectively. See: <a href="https://brand.umd.edu/colors">UMD’s brand standard</a> for the entire palette.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/plot_color-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
</section>
</section>
<section id="logit-with-continuous-ivs" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="logit-with-continuous-ivs"><span class="header-section-number">7.3</span> Logit with continuous IVs</h2>
<p>The options above all assumed that you were looking for a small number of point predictions, but when we have a continuous variable, we might want to take full advantage of our data and see predictions across the full range of potential values. For the next set of examples, we’ll use the same model from the prior section, but we’ll create predictions across all levels of the <code>union10</code> variable. For simplicity’s sake, we’ll only vary <code>union10</code> and <code>abort_rank3</code> and we can just hold <code>south = "South"</code>.</p>
<section id="generating-the-predictions-1" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="generating-the-predictions-1"><span class="header-section-number">7.3.1</span> Generating the predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-47"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-47-1"><a href="#annotated-cell-47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fake states at every level of union10 and abort_rank3 </span></span>
<span id="annotated-cell-47-2"><a href="#annotated-cell-47-2" aria-hidden="true" tabindex="-1"></a>state_cases <span class="ot">=</span> <span class="fu">expand.grid</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-47" data-target-annotation="1">1</button><span id="annotated-cell-47-3" class="code-annotation-target"><a href="#annotated-cell-47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">union10 =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span> ,</span>
<span id="annotated-cell-47-4"><a href="#annotated-cell-47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">abort_rank3 =</span> <span class="fu">c</span>(<span class="st">"More restr"</span>, <span class="st">"Mid"</span>, <span class="st">"Less restr"</span>),  <span class="co"># all three levels</span></span>
<span id="annotated-cell-47-5"><a href="#annotated-cell-47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">south =</span> <span class="fu">c</span>(<span class="st">"South"</span>)) <span class="co">#  holding south constant</span></span>
<span id="annotated-cell-47-6"><a href="#annotated-cell-47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use the pred_ci function with the same syntax you would use for predict(). </span></span>
<span id="annotated-cell-47-7"><a href="#annotated-cell-47-7" aria-hidden="true" tabindex="-1"></a>union_preds <span class="ot">=</span> <span class="fu">pred_ci</span>(<span class="at">model =</span> states_model, <span class="at">newdata=</span>state_cases)</span>
<span id="annotated-cell-47-8"><a href="#annotated-cell-47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use the pred_ci function  with the same syntax you would use for predict(). </span></span>
<span id="annotated-cell-47-9"><a href="#annotated-cell-47-9" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">pred_ci</span>(<span class="at">model =</span> states_model, <span class="at">newdata=</span>state_cases)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-47" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-47" data-code-annotation="1" data-code-lines="3">Instead of setting <code>union10</code> to its mean, we allow it to take on any value from 0 to 30.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="using-plot-1" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="using-plot-1"><span class="header-section-number">7.3.2</span> Using plot()</h3>
<p>Here we just subset by levels of <code>abort_rank3</code>, create an empty plotting space, and then use the <code>lines</code> function to draw the line of best fit in the plotting space. Remember that the <code>lty</code> option is going to control the style of lines. We can use the line type to distinguish the predictions from each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create three subsets - one for each level of abort_rank3</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>less_restr <span class="ot">=</span> <span class="fu">subset</span>(union_preds, abort_rank3<span class="sc">==</span><span class="st">"Less restr"</span>) </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>mid_restr <span class="ot">=</span> <span class="fu">subset</span>(union_preds, abort_rank3<span class="sc">==</span><span class="st">"Mid"</span>)        </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>most_restr <span class="ot">=</span> <span class="fu">subset</span>(union_preds, abort_rank3<span class="sc">==</span><span class="st">"More restr"</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create an empty plotting space</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="st">""</span>,  <span class="at">y=</span><span class="st">""</span> , <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">axes=</span>T, </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"% state workforce that is unionized"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Probability of Obama winning state in 2012"</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Predicted probability of Obama win in 2012</span><span class="sc">\n</span><span class="st">by % unionization and abortion laws"</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create three separate lines</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>less_restr<span class="sc">$</span>union10, <span class="at">y=</span>less_restr<span class="sc">$</span>fit, <span class="at">lty=</span><span class="dv">1</span>) <span class="co"># lty =1  is a solid line</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>mid_restr<span class="sc">$</span>union10, <span class="at">y=</span>mid_restr<span class="sc">$</span>fit, <span class="at">lty=</span><span class="dv">2</span>) <span class="co"># lty = 2 is a dashed line</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>most_restr<span class="sc">$</span>union10, <span class="at">y=</span>most_restr<span class="sc">$</span>fit, <span class="at">lty=</span><span class="dv">3</span>) <span class="co"># lty = 3 is a dotted line</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># now add a legend</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">3</span>), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Less restr"</span>, <span class="st">"Medium restr"</span>, <span class="st">"Most restr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
</section>
</section>
<section id="extra-stuff-prediction-plots-using-ggeffects" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Extra stuff: prediction plots using ggeffects</h1>
<p>This section is optional! Only use this if you’re already comfortable using the commands above! There is an alternative way to visualize logit results using an R package called <a href="https://strengejacke.github.io/ggeffects/">ggeffects</a> and the <a href="https://ggplot2.tidyverse.org/">ggplot2</a> library. Remember that, in order to use these commands, you have to <a href="https://bookdown.org/nana/intror/install-and-load-packages.html">install and then load both packages</a>.</p>
<section id="using-predict_response" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="using-predict_response"><span class="header-section-number">8.1</span> Using predict_response</h2>
<p>The ggeffects package has its own version of the <code>predict</code> function called <a href="https://strengejacke.github.io/ggeffects/reference/predict_response.html"><code>predict_response</code></a> that adds a lot of additional options for generating predictions. Most notably, it simplifies the process of generating hypothetical cases. Instead of creating a whole new data set, we can just list the terms we want to use as an optional argument for <code>predict_response</code>. Any covariates we leave out will be held at their “typical values” automatically. So the code below actually generates the same predictions we created in section 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects) </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(poliscidata)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>states_model <span class="ot">=</span> <span class="fu">glm</span>(obama_win12 <span class="sc">~</span> union10 <span class="sc">+</span> abort_rank3 <span class="sc">+</span> south, <span class="at">data=</span>states, <span class="at">family=</span>binomial)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get predictions. Use "terms=" instead of "newdata = "</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict_response</span>(states_model, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">'abort_rank3'</span>, <span class="st">'south'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># Predicted probabilities of obama_win12

south: Nonsouth

abort_rank3 | Predicted |     95% CI
------------------------------------
More restr  |      0.33 | 0.10, 0.67
Mid         |      0.65 | 0.34, 0.87
Less restr  |      0.77 | 0.39, 0.95

south: South

abort_rank3 | Predicted |     95% CI
------------------------------------
More restr  |      0.23 | 0.04, 0.67
Mid         |      0.53 | 0.19, 0.84
Less restr  |      0.67 | 0.20, 0.94

Adjusted for:
* union10 = 11.36</code></pre>
</div>
</div>
</section>
<section id="ggeffects-with-categorical-ivs" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="ggeffects-with-categorical-ivs"><span class="header-section-number">8.2</span> ggeffects with categorical IVs</h2>
<p>The only thing we might want to change here are the axis labels. The <code>ggeffects</code> plots are based on the <code>ggplot2</code> package, which is an alternative R plotting library with its own distinct grammar. The biggest difference is that we use the <code>+</code> sign to add stuff to ggplot objects. We can just use the <code>labs()</code> function to control the axis labels, add a title, and change the name of the legend in one step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-50"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-50-1"><a href="#annotated-cell-50-1" aria-hidden="true" tabindex="-1"></a>states_model <span class="ot">=</span> <span class="fu">glm</span>(obama_win12 <span class="sc">~</span> union10 <span class="sc">+</span> abort_rank3 <span class="sc">+</span> south, <span class="at">data=</span>states, <span class="at">family=</span>binomial)</span>
<span id="annotated-cell-50-2"><a href="#annotated-cell-50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-50-3"><a href="#annotated-cell-50-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict_response</span>(states_model, <span class="at">terms=</span><span class="fu">c</span>(<span class="st">'abort_rank3'</span>, <span class="st">'south'</span>))</span>
<span id="annotated-cell-50-4"><a href="#annotated-cell-50-4" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-50" data-target-annotation="1">1</button><span id="annotated-cell-50-5" class="code-annotation-target"><a href="#annotated-cell-50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(preds, <span class="at">colors=</span> <span class="fu">c</span>(<span class="st">"#e21833"</span>, <span class="st">"#000000"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-50-6"><a href="#annotated-cell-50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Abortion restrictions"</span>,</span>
<span id="annotated-cell-50-7"><a href="#annotated-cell-50-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"% chance Obama wins state"</span>, <span class="co"># y axis lable</span></span>
<span id="annotated-cell-50-8"><a href="#annotated-cell-50-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color  =</span> <span class="st">"Region"</span>, <span class="co"># the adjusts the name of the legend (not the color itself)</span></span>
<span id="annotated-cell-50-9"><a href="#annotated-cell-50-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted chance Obama wins state in 2012</span><span class="sc">\n</span></span>
<span id="annotated-cell-50-10"><a href="#annotated-cell-50-10" aria-hidden="true" tabindex="-1"></a><span class="st">       by region and level of abortion restriction"</span>, <span class="co"># overall title</span></span>
<span id="annotated-cell-50-11"><a href="#annotated-cell-50-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"% union held at mean"</span>  <span class="co"># a caption in the lower right hand side</span></span>
<span id="annotated-cell-50-12"><a href="#annotated-cell-50-12" aria-hidden="true" tabindex="-1"></a>       ) </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-50" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-50" data-code-annotation="1" data-code-lines="5">Notice the <code>+</code> sign here!</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/plot_ggeffects-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="ggeffects-with-continuous-ivs" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="ggeffects-with-continuous-ivs"><span class="header-section-number">8.3</span> ggeffects with continuous IVs</h2>
<p>The <code>predict_response</code> function will try to generate a plot that makes the most sense for the data you give it, so we want to be careful about how we order the columns when we create the <code>state_cases</code> object. In general: it is going to draw a ribbon plot if the first column is a continuous variable, and it will draw individual points if the first variable is a categorical variable. So we just want to make sure <code>union10</code> is the first column of <code>state_cases</code>. As long as we’ve got that, creating the plot is pretty easy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>states_model <span class="ot">=</span> <span class="fu">glm</span>(obama_win12 <span class="sc">~</span> union10 <span class="sc">+</span> abort_rank3 <span class="sc">+</span> south, <span class="at">data=</span>states, <span class="at">family=</span>binomial) </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>union_preds <span class="ot">=</span> <span class="fu">predict_response</span>(states_model, <span class="at">terms =</span><span class="fu">c</span>(<span class="st">"union10"</span>, <span class="st">"abort_rank3"</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(union_preds) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(  <span class="at">x =</span> <span class="st">"% state workforce that is unionized"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="st">"% chance of Obama winning state in 2012"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Predicted % chance of Obama win in 2012</span><span class="sc">\n</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="st">     by % unionization and abortion laws"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">'abortion restrictions'</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>You’ll notice that, by default, the plotting function gave us a semi-transparent region around each line. This shaded space represents the 95% confidence interval for each estimate. This is a little hard to see, so we might want to change this by adding the <code>facets=TRUE</code> option to the plot function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-52"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-52" data-target-annotation="1">1</button><span id="annotated-cell-52-1" class="code-annotation-target"><a href="#annotated-cell-52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(union_preds, <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="annotated-cell-52-2"><a href="#annotated-cell-52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% state workforce that is unionized"</span>,</span>
<span id="annotated-cell-52-3"><a href="#annotated-cell-52-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="st">"% chance of Obama winning state in 2012"</span>,</span>
<span id="annotated-cell-52-4"><a href="#annotated-cell-52-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Predicted % chance of Obama win in 2012</span><span class="sc">\n</span><span class="st">by % unionization and abortion laws"</span>,</span>
<span id="annotated-cell-52-5"><a href="#annotated-cell-52-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">'abortion restrictions'</span></span>
<span id="annotated-cell-52-6"><a href="#annotated-cell-52-6" aria-hidden="true" tabindex="-1"></a>     )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-52" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-52" data-code-annotation="1" data-code-lines="1">If your categorical variable has vague labels like “Yes” and “No” you might want to adjust those to something more descriptive before using the facet option. Otherwise, readers might not be able to interpret what your facets are actually depicting.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="ggeffects-with-multiple-continuous-ivs" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="ggeffects-with-multiple-continuous-ivs"><span class="header-section-number">8.4</span> ggeffects with Multiple continuous IVs</h2>
<p>While there’s no ggeffects equivalent of the <code>persp</code> function, we do still have some options for plotting multiple continuous if we just restrict ourselves to looking at a handful of values for one of the continuous covariates. In the case below, we’ve kept all the values of <code>secularism</code> but we’ve limited the <code>gunlaw_rank</code> variable to only show the 1st, 25th, and 50th ranked state. In essence, we’re simplifying this problem by turning gun law ranking into a categorical variable, so once we do that, the syntax for creating our plots and predictions will be pretty similar to what we did in the prior section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-53"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-53-1"><a href="#annotated-cell-53-1" aria-hidden="true" tabindex="-1"></a>states_obama <span class="ot">=</span> <span class="fu">glm</span>(obama_win12  <span class="sc">~</span> secularism <span class="sc">+</span> gunlaw_rank, <span class="at">data=</span>states, <span class="at">family=</span>binomial) </span>
<span id="annotated-cell-53-2"><a href="#annotated-cell-53-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-53" data-target-annotation="1">1</button><span id="annotated-cell-53-3" class="code-annotation-target"><a href="#annotated-cell-53-3" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict_response</span>(states_obama , <span class="at">terms=</span><span class="fu">c</span>(<span class="st">"secularism"</span>, <span class="st">"gunlaw_rank[1, 25, 50]"</span>))</span>
<span id="annotated-cell-53-4"><a href="#annotated-cell-53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(preds) <span class="sc">+</span></span>
<span id="annotated-cell-53-5"><a href="#annotated-cell-53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"% chance"</span>, </span>
<span id="annotated-cell-53-6"><a href="#annotated-cell-53-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"secularism values"</span>, </span>
<span id="annotated-cell-53-7"><a href="#annotated-cell-53-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Gun restrictions ranking"</span>,</span>
<span id="annotated-cell-53-8"><a href="#annotated-cell-53-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted probabilities of Obama win in 2012"</span></span>
<span id="annotated-cell-53-9"><a href="#annotated-cell-53-9" aria-hidden="true" tabindex="-1"></a>       )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-53" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-53" data-code-annotation="1" data-code-lines="3">the ggeffects plotting function will try to guess what kind of plot you want based on the ordering of the terms here. In general, if you have a continuous variable, you’ll want to list that part first, followed by the categorical variable <a href="https://strengejacke.github.io/ggeffects/reference/predict_response.html#:~:text=A%20model%20object.-,terms,-Names%20of%20those">see</a></span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<p><img src="tips_for_final_project_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="marginal-effects-1" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="marginal-effects-1"><span class="header-section-number">8.5</span> Marginal Effects</h2>
<p>An average marginal effect can be interpreted as the effect of a one unit change in the independent variable on the predicted probability of the dependent variable. However, since the effect of X on Y in a logistic regression is non-linear, the “marginal effect” is not going to be the same for everyone: some people will already have a very high probability of experiencing the outcome of interest, so the marginal effect of a change in some variable will be very small, compared with someone whose chances for the outcome were around 50/50.</p>
<p>One way to account for this is by averaging the effect of a one unit change for every observation in your original data. In other words: if every state experienced a one-unit increase in unionization how much would that increase the average predicted probability of <code>obama_win12</code>? We can calculate this using code we’ve already used in the past. We just need to get the predictions for everyone, and then get the predictions for everyone after increasing each state’s value of union10 by 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get predictions for the original data</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>original_preds <span class="ot">=</span> <span class="fu">predict</span>(states_model ,<span class="at">type=</span><span class="st">'response'</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># increase union10 by 1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">=</span> <span class="fu">replace</span>(states,<span class="st">"union10"</span>, states<span class="sc">$</span>union10<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get predictions with union10 at 1 value higher</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>preds_plus1 <span class="ot">=</span> <span class="fu">predict</span>(states_model, <span class="at">newdata=</span>newdata, <span class="at">type=</span><span class="st">'response'</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get the average change in probability of Y=1</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(preds_plus1 <span class="sc">-</span> original_preds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02885444</code></pre>
</div>
</div>
<p>So the average effect of a one unit increase in <code>union10</code> is about a 3 percentage point increase in the probability that Obama will win a state in 2012.</p>
<p>The <a href="https://marginaleffects.com/"><code>marginaleffects</code></a> package actually provides a function that will calculate this for us automatically for all of our covariates, and it will give us confidence intervals around each, and measures of statistical significance:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(states_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 24%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">s.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">abort_rank3</td>
<td style="text-align: left;">Less restr - More restr</td>
<td style="text-align: right;">0.344</td>
<td style="text-align: right;">0.223</td>
<td style="text-align: right;">1.545</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">3.032</td>
<td style="text-align: right;">-0.092</td>
<td style="text-align: right;">0.781</td>
</tr>
<tr class="even">
<td style="text-align: left;">abort_rank3</td>
<td style="text-align: left;">Mid - More restr</td>
<td style="text-align: right;">0.238</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">1.496</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">2.893</td>
<td style="text-align: right;">-0.074</td>
<td style="text-align: right;">0.550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">south</td>
<td style="text-align: left;">South - Nonsouth</td>
<td style="text-align: right;">-0.075</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">-0.560</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.797</td>
<td style="text-align: right;">-0.339</td>
<td style="text-align: right;">0.188</td>
</tr>
<tr class="even">
<td style="text-align: left;">union10</td>
<td style="text-align: left;">+1</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">2.412</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">5.978</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.052</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Our interpretation here would be: a one unit change in union10 would increase the probability of a state voting for Obama in 2012 by around ~2.9 percentage points (all else equal). The average marginal effect of being in the South compared to being outside the South is about a 0.7 percentage point decrease in the probability of voting for Obama in 2012. Moving a state from the highest level of abortion restrictions to the least restrictive would increase the probability of an Obama win by around 34 percent points.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>